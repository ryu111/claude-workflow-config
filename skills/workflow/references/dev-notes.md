# 開發筆記指南（Dev Notes Guide）

> 執行過程中想到但不需當下處理的事項，統一記錄到專案筆記本

---

## 筆記本位置

```
project/
└── openspec/
    └── changes/
        └── [change-id]/
            └── notes.md    ← 開發筆記本
```

**重要**：筆記本放在專案的 OpenSpec 變更目錄內，隨變更一起歸檔。

---

## 記錄時機

### 應該記錄

| 類型 | 觸發情況 | 範例 |
|------|----------|------|
| **優化建議** | 發現可以改進但非當前任務 | 「這個 O(n²) 可以優化成 O(n)」 |
| **未來功能** | 想到相關但不在範圍內的功能 | 「未來可以支援批次操作」 |
| **技術債** | 為了趕進度用了臨時方案 | 「hardcode 了這個值，之後要改成配置」 |
| **文檔待補** | 發現文檔不足 | 「API 缺少使用範例」 |
| **測試待加** | 發現測試覆蓋不足 | 「邊界情況需要更多測試」 |
| **安全考量** | 發現潛在安全問題 | 「這個 endpoint 需要加入 rate limit」 |
| **效能觀察** | 發現效能可以改進 | 「這個查詢在大數據量時可能變慢」 |

### 不應該記錄

| 類型 | 原因 | 處理方式 |
|------|------|----------|
| 當前任務的 bug | 必須立即修復 | 直接修復 |
| 阻擋進度的問題 | 必須立即處理 | 停下來解決 |
| 用戶明確要求的功能 | 應該加入 tasks.md | 加入任務清單 |

---

## 筆記格式

```markdown
# 開發筆記 - [change-id]

> 執行過程中想到但不需當下處理的事項

## 優化建議
- [ ] `src/api/user.ts:45` - 可以用 memoization 優化查詢
- [ ] `src/services/auth.ts` - 錯誤處理可以更細緻，區分不同錯誤類型

## 未來功能
- [ ] 加入批次處理 API，支援一次操作多筆資料
- [ ] 支援多語言（i18n）
- [ ] 加入 WebSocket 即時通知

## 技術債
- [ ] `src/utils/helper.ts:23` - 臨時用 any 類型，需要定義正確類型
- [ ] `src/db/queries.ts` - SQL 查詢可以用 ORM 重構

## 文檔待補
- [ ] API 文檔需要使用範例
- [ ] 部署流程需要更新
- [ ] 架構圖需要更新

## 測試待加
- [ ] `UserService` 缺少邊界測試
- [ ] 需要加入整合測試

## 安全考量
- [ ] `/api/upload` 需要檔案類型驗證
- [ ] 需要加入 CSRF 保護

## 效能觀察
- [ ] `getUsers()` 在用戶數 > 10000 時可能變慢
- [ ] 考慮加入分頁機制
```

---

## 使用方式

### 執行中記錄

當在開發過程中想到值得記錄的事項時：

```python
# 1. 檢查 notes.md 是否存在
Read("openspec/changes/[change-id]/notes.md")

# 2. 如果不存在，建立新檔案
Write("openspec/changes/[change-id]/notes.md", template)

# 3. 如果存在，追加新內容
Edit("openspec/changes/[change-id]/notes.md", ...)
```

### 結束時檢查

工作流結束時，必須：

```
1. 讀取 notes.md
2. 如果有內容，在最終報告中列出
3. 詢問用戶：
   - 是否要將某些項目加入下一個工作流？
   - 是否要保留筆記供參考？
   - 是否要刪除已處理的項目？
```

---

## 最終報告格式

```markdown
═══════════════════════════════════════════════════════════
📋 工作流完成報告 - [change-id]
═══════════════════════════════════════════════════════════

【任務完成情況】
✅ 已完成：8/8 任務
📁 已歸檔：openspec/archive/[change-id]/

【清理報告】
🗑️ 刪除：__pycache__/ (5), .pytest_cache/ (1)
📦 歸檔：TASK_*.md → docs/archive/

───────────────────────────────────────────────────────────

📝 **開發筆記提醒**（共 7 項）

**優化建議** (2)
- [ ] src/api/user.ts:45 - 可以用 memoization 優化
- [ ] src/services/auth.ts - 錯誤處理可以更細緻

**未來功能** (2)
- [ ] 加入批次處理 API
- [ ] 支援多語言

**技術債** (1)
- [ ] src/utils/helper.ts - 臨時解法，需要重構

**文檔待補** (2)
- [ ] API 文檔需要範例
- [ ] 部署流程文檔

───────────────────────────────────────────────────────────

❓ 是否要將這些項目加入下一個工作流？

═══════════════════════════════════════════════════════════
```

---

## 歸檔處理

當工作流歸檔時，`notes.md` 會一起移動到歸檔目錄：

```
openspec/archive/[change-id]/
├── proposal.md
├── tasks.md
├── notes.md    ← 保留供未來參考
└── specs/
```

這樣未來可以：
- 回顧當時的想法
- 追蹤哪些建議已實現
- 作為新工作流的參考
